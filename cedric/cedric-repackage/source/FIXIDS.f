      SUBROUTINE FIXIDS(IPR,KRD)
C
C        ALTERS ID HEADER - ONE WORD AT A TIME
C
      INCLUDE 'CEDRIC.INC'
      COMMON /VOLUME/ INPID(NID),ID(NID),NAMF(4,NFMAX),SCLFLD(NFMAX),
     X                IRCP(NFMAX),MAPVID(NFMAX,2),CSP(3,3),NCX(3),
     X                NCXORD(3),NFL,NPLANE,BAD
      CHARACTER*2 NAMF
      DATA ILBD,IUBD,ISF,ICF/1,395,68,69/
C
C        USED TO INITIALIZE WORD TYPES OF 16-BIT CARTESIAN HEADER
C        FILL ITYP WITH MODES OF DATA OF ID HEADER SUCH THAT ITYP(J)
C        CONTAINS A CODE EXPLAINING THE TYPE OF DATA FOUND IN WORD(J)
C           CODE:
C              -2 = ALPHABETIC
C              -1 = UNSCALED INTEGER
C               0 = DEAD WORD
C               1 = SCALED INTEGER (*SF) TRUE VAL = STORED VAL / SF
C               2 = SCALED INTEGER (/SF) TRUE VAL = STORED VAL * SF
C               3 = SCALED INTEGER (*CF) TRUE VAL = STORED VAL / CF
C
C           CURRENTLY SF CAN BE FOUND IN ID(68) AND CF IN ID(69)
C
      DIMENSION ITYP(NID)
      CHARACTER*(*) KRD(10)
C
C        SET ALL TO BE ALPHABETIC
C
      DATA (ITYP(I),I=1,20)/20*-2/
      DATA (ITYP(I),I=43,58)/16*-2/
      DATA ITYP(62),ITYP(66),ITYP(151)/3*-2/
      DATA (ITYP(I),I=71,94)/24*-2/
      DATA (ITYP(I),I=101,104)/4*-2/
      DATA (ITYP(I),ITYP(I+1),ITYP(I+2),ITYP(I+3),I=176,296,5)/100*-2/
      DATA (ITYP(I),ITYP(I+1),ITYP(I+2),I=306,390,6)/45*-2/
C
C        SET UNSCALED INTEGERS
C
      DATA (ITYP(I),I=21,34), ITYP(35), ITYP(36) /14*-1, 1, -1/
      DATA ITYP(37), ITYP(38), ITYP(39) /-1, 1, -1/
      DATA ITYP(60),ITYP(61),ITYP(63),ITYP(64),ITYP(65)/5*-1/
      DATA (ITYP(I),I=95,100)/6*-1/
      DATA ITYP(106), ITYP(107), ITYP(108), ITYP(109) /-1, 2, 2, 1/
      DATA ITYP(110), ITYP(111) /2*-1/
      DATA (ITYP(I),I=112,115)/4*0/
      DATA (ITYP(I),I=116,129)/14*-1/
      DATA ITYP(130),ITYP(131),ITYP(132),ITYP(133) /2*0, 2*1/
      DATA (ITYP(I),I=134,137),ITYP(138),ITYP(139) /4*-1, 0, -1/
      DATA ITYP(140),ITYP(141) /2*0/
      DATA (ITYP(I),I=142,143),ITYP(144),ITYP(145) /2*3, -1, 3/
      DATA (ITYP(I),I=146,150) /5*-1/
      DATA (ITYP(I),I=152,153),ITYP(154) /2*3,-1/
      DATA (ITYP(I),I=155,156),ITYP(157),ITYP(158) /2*3, -1, 3/
      DATA ITYP(159),ITYP(160),ITYP(161),ITYP(162) /-1, 1, 1, -1/
      DATA ITYP(163),ITYP(164),ITYP(165),ITYP(166) /-1, -1, 1, 1/
      DATA ITYP(167),ITYP(168),ITYP(169),ITYP(170),ITYP(171) /3*-1,2*1/
      DATA (ITYP(I),I=172,175) /4*-1/
      DATA ITYP(67),ITYP(68),ITYP(69),ITYP(301),ITYP(302)/5*-1/
      DATA ITYP(180),ITYP(185),ITYP(190),ITYP(195),ITYP(200)/5*-1/
      DATA ITYP(205),ITYP(210),ITYP(215),ITYP(220),ITYP(225)/5*-1/
      DATA ITYP(230),ITYP(235),ITYP(240),ITYP(245),ITYP(250)/5*-1/
      DATA ITYP(255),ITYP(260),ITYP(265),ITYP(270),ITYP(275)/5*-1/
      DATA ITYP(280),ITYP(285),ITYP(290),ITYP(295),ITYP(300)/5*-1/
      DATA ITYP(303)/-1/
      DATA ITYP(311),ITYP(317),ITYP(323),ITYP(329),ITYP(335)/5*-1/
      DATA ITYP(341),ITYP(347),ITYP(353),ITYP(359),ITYP(365)/5*-1/
      DATA ITYP(371),ITYP(377),ITYP(383),ITYP(389),ITYP(395)/5*-1/
C
C        SET DEAD WORDS
C
      DATA ITYP(59),ITYP(70),ITYP(105)/3*0/
C
C        SET SCALED INTEGERS (*SF)
C
      DATA ITYP(41),ITYP(42)/1,1/
      DATA ITYP(304),ITYP(305)/2*1/
      DATA ITYP(309),ITYP(310),ITYP(315),ITYP(316),ITYP(321)/5*1/
      DATA ITYP(322),ITYP(327),ITYP(328),ITYP(333),ITYP(334)/5*1/
      DATA ITYP(339),ITYP(340),ITYP(345),ITYP(346),ITYP(351)/5*1/
      DATA ITYP(352),ITYP(357),ITYP(358),ITYP(363),ITYP(364)/5*1/
      DATA ITYP(369),ITYP(370),ITYP(375),ITYP(376),ITYP(381)/5*1/
      DATA ITYP(382),ITYP(387),ITYP(388),ITYP(393),ITYP(394)/5*1/
C
C        SET SCALED INTEGERS (*CF)
C
      DATA ITYP(40)/3/


C
C        ALTER WORD OF HEADER
C
      J=0
 200  CONTINUE
      J=J+2
      IF(J.GT.8) GO TO 600
      IF(KRD(J).EQ.'RAD(X)')THEN
         NWD=315
      ELSE IF(KRD(J).EQ.'RAD(Y)')THEN
         NWD=316
      ELSE
         READ (KRD(J),101)RWD
 101     FORMAT(F8.0)
         NWD=RWD
      END IF
      IF (NWD.EQ.0) GOTO 600
      IF ((NWD.GE.ILBD) .AND. (NWD.LE.IUBD)) GOTO 210
      WRITE(IPR,203) ILBD,IUBD
 203  FORMAT (/5X,'+++  USER MAY ONLY ALTER WORDS ',I3,' - ',I3)
      GOTO 200
 210  CONTINUE
      ICD=ITYP(NWD)
      GOTO (221,230,250,300,350,400), ICD+3
 221  CONTINUE
C
C        ALPHABETIC
C
      ILCH=ID(NWD)
      NWCH=0
      READ (KRD(J+1),206)NWCH
  206 FORMAT(A4)
      WRITE(IPR,207) NWD,ILCH,NWCH
 207  FORMAT (5X,'WORD #',I3,' CHANGED FROM ',A8,' TO ',A8)
      ID(NWD)=NWCH
      GOTO 200
C
C        UNSCALED INTEGER
C
 230  CONTINUE
      SCALE=1.0
      GOTO 500
C
C        DEAD WORD
C
 250  CONTINUE
      WRITE(IPR,251) NWD
 251  FORMAT (5X,'WORD #',I3,' CANNOT BE ALTERED')
      GOTO 200
C
C
C        SCALED INTEGER (*SF)
C
 300  CONTINUE
      SCALE=1.0/ID(ISF)
      GOTO 500
C
C        SCALED INTEGER (/SF)
C
 350  CONTINUE
      SCALE=ID(ISF)
      GOTO 500
C
C        SCALED INTEGER (*CF)
C
 400  CONTINUE
      SCALE=1.0/ID(ICF)
C
C        SCALE HAS BEEN SET TO SCALAR FACTOR SUCH THAT
C           TRUE VALUE = STORED VALUE * SCALE
C
 500  CONTINUE
      ISVL=ID(NWD)
      OTVL=ISVL*SCALE
      IF(KRD(J).EQ.'RAD(X)')THEN
         SCF = 1.0/ID(68)
         WTVL = ID(36) + ID(37)/60.0 + SCF*ID(38)/3600.0
      ELSE IF(KRD(J).EQ.'RAD(Y)')THEN
         SCF = 1.0/ID(68)
         WTVL = ID(33) + ID(34)/60.0 + SCF*ID(35)/3600.0
      ELSE
         READ (KRD(J+1),101)WTVL
      END IF
      WRITE(IPR,503) NWD,OTVL,WTVL
 503  FORMAT (5X,'WORD #',I3,' CHANGED FROM ',F8.2,' TO ',F8.2)
      ID(NWD)=NINT(WTVL/SCALE)
      GOTO 200
C
C        RETURN TO SENDER , ADDRESS UNKNOWN
C
 600  CONTINUE
      print *,"FIXIDS: BEFORE NEWHED",id(160),id(161),id(165),id(166)
      CALL NEWHED(1)
      RETURN
      END
